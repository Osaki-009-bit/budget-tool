<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>轻记账｜客观统计工具</title>

<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#f6f7fb;}
.wrap{max-width:980px;margin:0 auto;padding:16px;}
.layout{display:flex;gap:12px;align-items:flex-start;}
.sidebar{width:170px;position:sticky;top:12px;background:#fff;border-radius:16px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);}
.month-nav{display:flex;flex-direction:column;gap:6px;}
.month-item{border:1px solid #e6e6e6;border-radius:12px;padding:10px;cursor:pointer;display:flex;justify-content:space-between;}
.month-item.active{background:#111;color:#fff;}
.main{flex:1;}
.card{background:#fff;border-radius:16px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);}
label{display:block;margin-top:12px;font-size:14px;}
input{width:100%;padding:12px;border-radius:12px;border:1px solid #ddd;}
.btn-primary{background:#111;color:#fff;border-radius:12px;padding:10px;border:0;cursor:pointer;width:100%;margin-top:10px;}

#monthCalendar{
  margin-top:8px;
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
}
.day-cell{
  padding:8px 0;
  text-align:center;
  border-radius:10px;
  font-size:13px;
  cursor:pointer;
  border:2px solid transparent;
}
.day-empty{visibility:hidden;}
.day-none{background:#f0f0f0;color:#999;}
.day-recorded{background:#e8f5e9;border-color:#2e7d32;}
.day-edited{background:#fdecea;border-color:#c62828;}
.day-active{background:#fff;border-color:#111;font-weight:700;}
</style>
</head>

<body>
<div class="wrap">
  <div class="layout">
    <aside class="sidebar">
      <div class="month-nav" id="monthNav"></div>
    </aside>

    <main class="main">
      <div class="card">
        <label>编辑日期</label>
        <input id="datePicker" type="date" />
        <label>本月日历（颜色=状态）</label>
        <div id="monthCalendar"></div>

        <label>当天花销</label>
        <input id="dayInput" type="number" />
        <button class="btn-primary" id="recordBtn">保存</button>
      </div>
    </main>
  </div>
</div>

<script>
const pad2=n=>String(n).padStart(2,'0');
const now=new Date();
const todayYmd=`${now.getFullYear()}-${pad2(now.getMonth()+1)}-${pad2(now.getDate())}`;
let activeYm=todayYmd.slice(0,7);
let editYmd=todayYmd;

const data=JSON.parse(localStorage.getItem('budgetDemo')||'{}');
data[activeYm]=data[activeYm]||{};

function renderMonthCalendar(){
  const cal=document.getElementById('monthCalendar');
  const days=new Date(activeYm.split('-')[0],activeYm.split('-')[1],0).getDate();
  let html='';
  for(let d=1;d<=days;d++){
    const ymd=`${activeYm}-${pad2(d)}`;
    const rec=data[activeYm][ymd];
    let cls='day-none';
    if(rec){cls=rec.edited?'day-edited':'day-recorded';}
    if(ymd===editYmd)cls+=' day-active';
    html+=`<div class="day-cell ${cls}" data-d="${ymd}">${d}</div>`;
  }
  cal.innerHTML=html;
  cal.querySelectorAll('.day-cell').forEach(el=>{
    el.onclick=()=>{
      editYmd=el.dataset.d;
      document.getElementById('datePicker').value=editYmd;
      document.getElementById('dayInput').value=data[activeYm][editYmd]?.total||'';
      renderMonthCalendar();
    };
  });
}

document.getElementById('recordBtn').onclick=()=>{
  const v=document.getElementById('dayInput').value;
  const prev=data[activeYm][editYmd];
  data[activeYm][editYmd]={total:Number(v),edited:!!prev};
  localStorage.setItem('budgetDemo',JSON.stringify(data));
  renderMonthCalendar();
};

document.getElementById('datePicker').value=todayYmd;
renderMonthCalendar();
</script>
</body>
</html>
